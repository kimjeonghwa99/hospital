<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Hospital ERP - Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#f3f5ff; color:#222; }
    .topbar { background:#4b53d3; color:#fff; padding:14px 18px; display:flex; justify-content:space-between; align-items:center; }
    .logout { border:1px solid rgba(255,255,255,0.5); background:transparent; color:#fff; padding:8px 10px; border-radius:10px; cursor:pointer; }
    .page { max-width:1000px; margin:16px auto; padding:0 16px 24px; }
    .card { background:#fff; border-radius:16px; box-shadow:0 8px 18px rgba(0,0,0,0.08); padding:14px; }
    .wrap { display:grid; grid-template-columns:260px 1fr; gap:14px; margin-top:14px; }
    .menu a { display:block; padding:10px 12px; margin-bottom:8px; background:#f6f7ff; border-radius:12px; text-decoration:none; color:#222; }
    .menu a:hover { background:#eceeff; }
    .grid { display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap:12px; margin-top:12px; }
    .stat { border:1px solid #eee; border-radius:14px; padding:12px; }
    .stat .label { font-size:12px; color:#666; margin-bottom:6px; }
    .stat .value { font-size:18px; font-weight:700; }
    .btn { margin-top:10px; padding:10px; border-radius:12px; border:none; cursor:pointer; background:#4b53d3; color:#fff; font-size:14px; width:100%; }
    .btn.out { background:#666; }
    .notice { margin-top:12px; padding:12px; background:#fff7e6; border-radius:14px; font-size:13px; color:#7a4b00; line-height:1.4; border:1px solid #ffe5b0; }
    @media (max-width:860px){ .wrap { grid-template-columns:1fr; } }
  </style>
</head>
<body>

  <div class="topbar">
    <div><b>Hospital ERP</b></div>
    <div>
      <span id="userInfo">사용자</span>
      <button class="logout" id="logoutBtn">로그아웃</button>
    </div>
  </div>

  <div class="page">
    <div class="wrap">

      <div class="card menu">
        <a href="#" onclick="alert('준비중입니다.'); return false;">근태(출퇴근)</a>
        <a href="#" onclick="alert('준비중입니다.'); return false;">직원 관리</a>
        <a href="#" onclick="alert('준비중입니다.'); return false;">환자/상담</a>
        <a href="#" onclick="alert('준비중입니다.'); return false;">예약</a>
        <a href="#" onclick="alert('준비중입니다.'); return false;">설정</a>
      </div>

      <div class="card">
        <h2 id="welcomeTitle">대시보드</h2>
        <div style="font-size:13px; color:#666;">초기 개발 단계(데모) 화면입니다.</div>

        <div class="grid">
          <div class="stat">
            <div class="label">직군</div>
            <div class="value" id="roleText">-</div>
          </div>

          <div class="stat">
            <div class="label">오늘 출근</div>
            <div class="value" id="checkInText">미처리</div>
            <button class="btn" id="checkInBtn">출근하기</button>
          </div>

          <div class="stat">
            <div class="label">오늘 퇴근</div>
            <div class="value" id="checkOutText">미처리</div>
            <button class="btn out" id="checkOutBtn">퇴근하기</button>
          </div>

          <div class="stat">
            <div class="label">로그인 상태</div>
            <div class="value">정상</div>
          </div>
        </div>

        <div class="notice" id="distanceNotice">
          출근/퇴근은 병원 반경 300m 이내에서만 가능합니다. (데모: 브라우저 GPS 사용)
        </div>
      </div>

    </div>
  </div>

  <script>
    // ===== 로그인 체크 =====
    if (!localStorage.getItem('auth_token')) location.href = './login.html';

    const name = localStorage.getItem('demo_user_name') || '사용자';
    const email = localStorage.getItem('demo_user_email') || '';
    const role = localStorage.getItem('demo_user_role') || '';

    const roleMap = { doctor:'의사', nurse:'간호사', counselor:'상담실장', admin:'관리자' };

    document.getElementById('userInfo').textContent = email ? `${name} (${email})` : name;
    document.getElementById('welcomeTitle').textContent = `${name}님, 환영합니다`;
    document.getElementById('roleText').textContent = roleMap[role] || '미설정';

    document.getElementById('logoutBtn').addEventListener('click', () => {
      localStorage.removeItem('auth_token');
      location.href = './login.html';
    });
  </script>

  <!-- geo.js 먼저 -->
  <script src="js/geo.js"></script>
  <!-- attendance.js가 geo.js를 사용 -->
  <script src="js/attendance.js"></script>

</body>
</html>
